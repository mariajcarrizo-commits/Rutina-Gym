<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <title>MAJO-FIT üíã ‚Äî PRO</title>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 15px;
      touch-action: manipulation;
    }
    .container { max-width: 1100px; margin: 0 auto; }

    h1 {
      color: white;
      text-align: center;
      margin-bottom: 10px;
      font-size: 2em;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    .subtitle {
      color: rgba(255,255,255,0.9);
      text-align: center;
      font-weight: 700;
      margin-bottom: 18px;
      font-size: 0.95em;
    }

    /* TIMER */
    .timer-container {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 16px;
      padding: 18px;
      margin-bottom: 18px;
      text-align: center;
      color: white;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    }
    .timer-container h2 { font-size: 1.2em; margin-bottom: 10px; }
    .timer-display {
      font-size: 3.2em;
      font-weight: 900;
      margin: 12px 0;
      font-family: 'Courier New', monospace;
      letter-spacing: 1px;
    }
    .timer-controls {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 10px;
    }
    .timer-btn {
      padding: 12px 16px;
      border: 2px solid white;
      border-radius: 10px;
      background: transparent;
      color: white;
      font-weight: 900;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 1em;
      -webkit-user-select: none;
      user-select: none;
    }
    .timer-btn:active { transform: scale(0.96); background: white; color: #667eea; }

    .timer-presets {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      margin-top: 12px;
    }
    .preset-btn {
      padding: 12px;
      border: 1px solid rgba(255,255,255,0.55);
      border-radius: 10px;
      background: rgba(255,255,255,0.18);
      color: white;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 0.95em;
      font-weight: 900;
      -webkit-user-select: none;
      user-select: none;
    }
    .preset-btn:active { background: rgba(255,255,255,0.35); transform: scale(0.96); }

    /* DAY SELECTOR */
    .day-selector {
      display: flex;
      gap: 10px;
      margin-bottom: 18px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .day-btn {
      padding: 14px 16px;
      border: none;
      border-radius: 10px;
      background: white;
      color: #667eea;
      font-weight: 900;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 1em;
      -webkit-user-select: none;
      user-select: none;
    }
    .day-btn:active { transform: scale(0.96); }
    .day-btn.active { background: #764ba2; color: white; }

    /* CONTENT */
    .routine-content {
      background: white;
      border-radius: 18px;
      padding: 18px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
    }
    .routine-section { display: none; }
    .routine-section.active { display: block; }

    .progress-bar {
      width: 100%;
      height: 34px;
      background: #e9ecef;
      border-radius: 17px;
      overflow: hidden;
      margin-bottom: 16px;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      transition: width 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 900;
      font-size: 1.05em;
      width: 0%;
    }

    .block {
      margin-bottom: 20px;
      border-left: 4px solid #667eea;
      padding-left: 14px;
    }
    .block-title {
      font-size: 1.15em;
      color: #667eea;
      margin-bottom: 10px;
      font-weight: 900;
    }
    .hint {
      color: #666;
      font-size: 0.92em;
      margin-top: -6px;
      margin-bottom: 10px;
      line-height: 1.35;
      font-weight: 600;
    }

    .exercise-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 12px;
      margin-bottom: 8px;
      background: #f7f7f7;
      border-radius: 10px;
      transition: all 0.2s ease;
      min-height: 62px;
      gap: 10px;
    }
    .exercise-item:active { background: #efefef; }
    .exercise-item.completed { background: #d4edda; opacity: 0.75; }
    .exercise-item.completed .exercise-text { text-decoration: line-through; }

    .exercise-text {
      flex: 1;
      font-size: 1em;
      color: #333;
      padding-right: 8px;
      font-weight: 800;
    }
    .set-checkboxes { display: flex; gap: 10px; flex-shrink: 0; }
    .set-checkbox { width: 34px; height: 34px; cursor: pointer; accent-color: #667eea; }

    /* TRACKING */
    .track-card {
      background: #f7f7f7;
      border-radius: 14px;
      padding: 14px;
      border: 1px solid rgba(0,0,0,0.06);
      margin-top: 10px;
    }
    .track-title {
      font-weight: 900;
      color: #333;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    .saved-badge {
      font-size: 0.85em;
      color: #1e7e34;
      font-weight: 900;
      background: #d4edda;
      padding: 6px 10px;
      border-radius: 999px;
      display: none;
    }
    .track-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }
    .field label {
      display: block;
      font-size: 0.85em;
      color: #555;
      margin-bottom: 4px;
      font-weight: 900;
    }
    .field input {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid #ddd;
      font-size: 1em;
      font-weight: 900;
      outline: none;
    }
    .save-row { display: flex; gap: 10px; margin-top: 12px; flex-wrap: wrap; }
    .save-btn {
      padding: 12px 16px;
      border: none;
      border-radius: 10px;
      background: #667eea;
      color: white;
      font-weight: 900;
      cursor: pointer;
      transition: 0.2s ease;
    }
    .save-btn:active { transform: scale(0.96); background: #5a6ee6; }
    .clear-btn {
      padding: 12px 16px;
      border: none;
      border-radius: 10px;
      background: #dc3545;
      color: white;
      font-weight: 900;
      cursor: pointer;
      transition: 0.2s ease;
    }
    .clear-btn:active { transform: scale(0.96); background: #c82333; }

    .reset-btn {
      display: block;
      margin: 18px auto 0;
      padding: 15px 26px;
      background: #dc3545;
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1em;
      font-weight: 900;
      cursor: pointer;
      transition: all 0.2s ease;
      -webkit-user-select: none;
      user-select: none;
    }
    .reset-btn:active { background: #c82333; transform: scale(0.96); }

    @media (max-width: 768px) {
      h1 { font-size: 1.7em; }
      .timer-display { font-size: 2.8em; }
      .routine-content { padding: 14px; }
      .exercise-text { font-size: 0.95em; }
      .set-checkbox { width: 32px; height: 32px; }
      .track-grid { grid-template-columns: 1fr; }
      .timer-presets { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>

<body>
  <!-- üîä AUDIO (ya lo ten√©s en assets/alarm.mp3) -->
  <audio id="alarmSound" preload="auto">
    <source src="assets/alarm.mp3" type="audio/mpeg">
  </audio>

  <div class="container">
    <h1>MAJO-FIT üíã</h1>
    <div class="subtitle">Rutina PRO </div>

    <!-- TIMER -->
    <div class="timer-container">
      <h2>‚è±Ô∏è Temporizador</h2>
      <div class="timer-display" id="timerDisplay">00:00</div>

      <div class="timer-controls">
        <button class="timer-btn" id="enableSoundBtn">üîä Activar sonido</button>
        <button class="timer-btn" id="startBtn">‚ñ∂Ô∏è Iniciar</button>
        <button class="timer-btn" id="pauseBtn" style="display:none;">‚è∏Ô∏è Pausar</button>
        <button class="timer-btn" id="resetTimerBtn">üîÑ Reiniciar</button>
      </div>

      <div class="timer-presets">
        <button class="preset-btn" data-seconds="45">45s</button>
        <button class="preset-btn" data-seconds="60">1min</button>
        <button class="preset-btn" data-seconds="90">1:30</button>
        <button class="preset-btn" data-seconds="120">2min</button>
        <button class="preset-btn" data-seconds="150">2:30</button>
        <button class="preset-btn" data-seconds="180">3min</button>
      </div>
    </div>

    <!-- DAY SELECTOR -->
    <div class="day-selector" id="daySelector"></div>

    <div class="routine-content">
      <div id="sections"></div>
      <button class="reset-btn" id="resetDayBtn">üîÑ Reiniciar D√≠a</button>
    </div>
  </div>

  <script>
    /**********************
     * PLAN PRO ‚Äî SIN POLEAS
     **********************/
    const PLAN = [
      {
        id: "d1",
        label: "LUN",
        title: "üçë Lunes ‚Äî Gl√∫teos + Femoral (HEAVY)",
        hints: [
          "Objetivo: tensi√≥n real + progresi√≥n. Descanso 90s.",
          "Finisher banda ANTES del cardio.",
          "Cervical friendly: nada sobre hombros."
        ],
        blocks: [
          {
            name: "üî• Fuerza (PRO)",
            items: [
              { text: "Hip Thrust (barra o corebag) ‚Äî 4x8-10", sets: 4 },
              { text: "Peso muerto rumano (mancuernas) ‚Äî 4x8-10", sets: 4 },
              { text: "Curl femoral m√°quina ‚Äî 4x10-12", sets: 4 },
              { text: "Patada gl√∫teo m√°quina (kickback) ‚Äî 4x10-12", sets: 4 },
              { text: "Abducci√≥n banda ‚Äî 4x20", sets: 4 }
            ]
          },
          {
            name: "üî• Finisher banda (x2)",
            items: [
              { text: "Abducciones banda ‚Äî 20", sets: 2 },
              { text: "Puente gl√∫teos con banda ‚Äî 20", sets: 2 }
            ]
          },
          {
            name: "üö¥ Cardio Zona 2",
            items: [
              { text: "Bici ‚Äî 20 a 25 min", sets: 1 }
            ]
          }
        ],
        tracking: ["hipthrust", "rdl"]
      },

      {
        id: "d2",
        label: "MAR",
        title: "üèãÔ∏è Martes ‚Äî Superior + Core (sin poleas)",
        hints: [
          "Postura fuerte: hombros atr√°s, cuello relajado.",
          "TRX + mancuernas + banda.",
          "ABS: calidad, no cantidad."
        ],
        blocks: [
          {
            name: "üí™ Superior",
            items: [
              { text: "TRX Remo (agarre neutro) ‚Äî 4x10-12", sets: 4 },
              { text: "Press pecho con mancuernas en banco ‚Äî 4x10", sets: 4 },
              { text: "Elevaciones laterales ‚Äî 4x12-15", sets: 4 },
              { text: "Face pull con banda ‚Äî 4x15", sets: 4 },
              { text: "Fondos en banco/caja ‚Äî 3x12-15", sets: 3 },
              { text: "B√≠ceps ‚Äî 3x12", sets: 3 }
            ]
          },
          {
            name: "üß† Core (3x)",
            items: [
              { text: "Plancha ‚Äî 40 seg", sets: 3 },
              { text: "Dead bug ‚Äî 12/12", sets: 3 }
            ]
          },
          {
            name: "üö£ Cardio Zona 2",
            items: [
              { text: "Remo ‚Äî 15 a 20 min", sets: 1 }
            ]
          }
        ],
        tracking: []
      },

      {
        id: "d3",
        label: "MI√â",
        title: "ü¶µ Mi√©rcoles ‚Äî Pierna + Gl√∫teo (PRNSA + B√öLGARAS)",
        hints: [
          "Prensa manda. B√∫lgaras te definen sin barra.",
          "Descanso 90s en Prensa y B√∫lgaras.",
          "Bajada lenta, subida fuerte."
        ],
        blocks: [
          {
            name: "üî• Pierna (PRO)",
            items: [
              { text: "Prensa ‚Äî 4x10-12", sets: 4 },
              { text: "B√∫lgaras con mancuernas ‚Äî 4x10 por pierna", sets: 4 },
              { text: "Extensi√≥n cu√°driceps ‚Äî 4x12-15", sets: 4 },
              { text: "Step ups en caja (con peso) ‚Äî 3x10 por pierna", sets: 3 },
              { text: "Patada gl√∫teo m√°quina ‚Äî 3x12 por pierna", sets: 3 },
              { text: "Abducci√≥n banda ‚Äî 3x20", sets: 3 }
            ]
          },
          {
            name: "üö¥ Cardio Zona 2",
            items: [
              { text: "Bici ‚Äî 25 a 30 min", sets: 1 }
            ]
          }
        ],
        tracking: ["prensa"]
      },
              {
        id: "d4",
        label: "JUE",
        title: "üèãÔ∏è Jueves ‚Äî Superior + Core (variaci√≥n)",
        hints: [
          "Todo con mancuernas + banda + TRX.",
          "Nada de cargas sobre hombros (cervical friendly).",
          "Descanso 60‚Äì90s."
        ],
        blocks: [
          {
            name: "üí™ Superior",
            items: [
              { text: "Remo ‚Äî 4x10-12", sets: 4 },
              { text: "Sentadilla sumo ‚Äî 4x10", sets: 4 },
              { text: "Fondo ‚Äî 3x12", sets: 3 },
              { text: "TRX ‚Äî 3x15", sets: 3 },
              { text: "Tr√≠ceps (pushdown) ‚Äî 3x15", sets: 3 },
              { text: "Curl martillo mancuernas ‚Äî 3x12", sets: 3 }
            ]
          },
          {
            name: "üß† Core (3x)",
            items: [
              { text: "Plancha lateral ‚Äî 30 seg por lado", sets: 3 },
              { text: "Crunch corto controlado ‚Äî 15", sets: 3 }
            ]
          },
          {
            name: "üö∂ Cardio suave",
            items: [
              { text: "Caminadora inclinaci√≥n ‚Äî 20 min", sets: 1 }
            ]
          }
        ],
        tracking: []
      },

      {
        id: "d5",
        label: "VIE",
        title: "üçë Viernes ‚Äî Lower + Pump + Finisher (gl√∫teo killer)",
        hints: [
          "Este d√≠a es el 'cierre de semana': bomba + t√©cnica.",
          "Descanso 60‚Äì90s.",
          "Finisher ANTES del cardio."
        ],
        blocks: [
          {
            name: "üî• Lower (PRO)",
            items: [
              { text: "Peso muerto rumano ‚Äî 4x10", sets: 4 },
              { text: "Hip thrust (barra o corebag) ‚Äî 4x10-12", sets: 4 },
              { text: "Prensa (pies altos) ‚Äî 3x12", sets: 3 },
              { text: "Curl femoral m√°quina ‚Äî 3x12", sets: 3 },
              { text: "Patada gl√∫teo m√°quina ‚Äî 3x12 por pierna", sets: 3 }
            ]
          },
          {
            name: "üî• Finisher (x2)",
            items: [
              { text: "Abducci√≥n banda ‚Äî 25", sets: 2 },
              { text: "Puente gl√∫teos con banda ‚Äî 25", sets: 2 },
              { text: "Step ups (sin peso) ‚Äî 20 total", sets: 2 }
            ]
          },
          {
            name: "üö¥ Cardio Zona 2",
            items: [
              { text: "Bici ‚Äî 20 a 25 min", sets: 1 }
            ]
          }
        ],
        tracking: ["hipthrust", "rdl", "prensa"]
      },

      {
        id: "d6",
        label: "S√ÅB",
        title: "‚ú® S√°bado ‚Äî Activo (recuperaci√≥n inteligente)",
        hints: [
          "Esto NO es vagancia: es estrategia.",
          "Tu cuerpo se adapta cuando descans√°s.",
          "Objetivo: movilidad + circulaci√≥n."
        ],
        blocks: [
          {
            name: "üßò Movilidad (1x)",
            items: [
              { text: "Movilidad cadera + gl√∫teo ‚Äî 10 min", sets: 1 },
              { text: "Movilidad espalda + cuello suave ‚Äî 8 min", sets: 1 },
              { text: "Caminata ‚Äî 30 min", sets: 1 }
            ]
          }
        ],
        tracking: []
      },

      {
        id: "d7",
        label: "DOM",
        title: "üò¥ Domingo ‚Äî Descanso total",
        hints: [
          "Tu cuerpo crece y se define ac√°.",
          "Hidrataci√≥n + prote√≠na + sue√±o.",
          "Nada de culpa."
        ],
        blocks: [
          {
            name: "üß† Reset",
            items: [
              { text: "Descanso total + pasos suaves", sets: 1 }
            ]
          }
        ],
        tracking: []
      }
    ];

    /**********************
     * TIMER PRO (audio + vibraci√≥n)
     **********************/
    let timerInterval = null;
    let remainingTime = 0;
    let isRunning = false;

    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = seconds % 60;
      return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }

    function updateTimerDisplay() {
      document.getElementById('timerDisplay').textContent = formatTime(remainingTime);
    }

    function setTimer(seconds) {
      remainingTime = seconds;
      updateTimerDisplay();
      if (isRunning) pauseTimer();
    }

    function playSound() {
      const audio = document.getElementById("alarmSound");
      if (!audio) return;

      audio.currentTime = 0;
      audio.play().catch(() => {});
    }

    function startTimer() {
      if (remainingTime === 0) setTimer(60);

      isRunning = true;
      document.getElementById('startBtn').style.display = 'none';
      document.getElementById('pauseBtn').style.display = 'inline-block';

      timerInterval = setInterval(() => {
        remainingTime--;
        updateTimerDisplay();

        if (remainingTime <= 0) {
          remainingTime = 0;
          updateTimerDisplay();
          pauseTimer();
          playSound();
          if (navigator.vibrate) navigator.vibrate([200, 100, 200, 100, 400]);
        }
      }, 1000);
    }

    function pauseTimer() {
      isRunning = false;
      clearInterval(timerInterval);
      document.getElementById('startBtn').style.display = 'inline-block';
      document.getElementById('pauseBtn').style.display = 'none';
    }

    function resetTimerFunc() {
      pauseTimer();
      remainingTime = 0;
      updateTimerDisplay();
    }

    /**********************
     * RENDER PRO (genera la rutina desde PLAN)
     **********************/
    function renderDays() {
      const selector = document.getElementById("daySelector");
      selector.innerHTML = "";

      PLAN.forEach((day, idx) => {
        const btn = document.createElement("button");
        btn.className = "day-btn" + (idx === 0 ? " active" : "");
        btn.textContent = day.label;
        btn.dataset.day = day.id;
        btn.addEventListener("click", () => showDay(day.id));
        selector.appendChild(btn);
      });
    }

    function renderSections() {
      const container = document.getElementById("sections");
      container.innerHTML = "";

      PLAN.forEach((day, idx) => {
        const section = document.createElement("div");
        section.className = "routine-section" + (idx === 0 ? " active" : "");
        section.id = day.id;

        // Progress bar
        const pb = document.createElement("div");
        pb.className = "progress-bar";
        pb.innerHTML = `<div class="progress-fill" id="progress-${day.id}">0%</div>`;
        section.appendChild(pb);

        // Title
        const title = document.createElement("div");
        title.className = "block";
        title.innerHTML = `<div class="block-title">${day.title}</div>`;
        section.appendChild(title);

        // Hints
        const hint = document.createElement("div");
        hint.className = "hint";
        hint.innerHTML = day.hints.map(h => `‚Ä¢ ${h}`).join("<br>");
        section.appendChild(hint);

        // Blocks
        day.blocks.forEach(block => {
          const blockDiv = document.createElement("div");
          blockDiv.className = "block";
          blockDiv.innerHTML = `<div class="block-title">${block.name}</div>`;

          block.items.forEach(item => {
            const ex = document.createElement("div");
            ex.className = "exercise-item";

            const text = document.createElement("span");
            text.className = "exercise-text";
            text.textContent = item.text;

            const boxes = document.createElement("div");
            boxes.className = "set-checkboxes";

            for (let i = 0; i < item.sets; i++) {
              const cb = document.createElement("input");
              cb.type = "checkbox";
              cb.className = "checkbox set-checkbox";
              cb.addEventListener("change", () => updateProgress(day.id));
              boxes.appendChild(cb);
            }

            ex.appendChild(text);
            ex.appendChild(boxes);
            blockDiv.appendChild(ex);
          });

          section.appendChild(blockDiv);
        });

        // Tracking card
        const track = document.createElement("div");
        track.className = "track-card";
        track.innerHTML = `
          <div class="track-title">
            üìà Registro PRO (opcional)
            <span class="saved-badge" id="saved-${day.id}">Guardado</span>
          </div>
          <div class="track-grid">
            <div class="field">
              <label>Hip Thrust (kg)</label>
              <input inputmode="numeric" id="track-${day.id}-hipthrust" placeholder="Ej: 30" />
            </div>
            <div class="field">
              <label>RDL / Peso muerto (kg)</label>
              <input inputmode="numeric" id="track-${day.id}-rdl" placeholder="Ej: 16" />
            </div>
            <div class="field">
              <label>Prensa (kg)</label>
              <input inputmode="numeric" id="track-${day.id}-prensa" placeholder="Ej: 80" />
            </div>
          </div>
          <div class="save-row">
            <button class="save-btn" data-day="${day.id}">üíæ Guardar registro</button>
            <button class="clear-btn" data-day="${day.id}">üóëÔ∏è Limpiar registro</button>
          </div>
        `;
        section.appendChild(track);

        container.appendChild(section);
      });
    }

    /**********************
     * UI + STORAGE
     **********************/
    function showDay(dayId) {
      document.querySelectorAll('.routine-section').forEach(section => section.classList.remove('active'));
      document.getElementById(dayId).classList.add('active');

      document.querySelectorAll('.day-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.day === dayId);
      });

      loadProgress(dayId);
      loadTracking(dayId);
    }

    function updateProgress(dayId) {
      const section = document.getElementById(dayId);
      const checkboxes = section.querySelectorAll('.checkbox');
      const items = section.querySelectorAll('.exercise-item');

      let completed = 0;
      checkboxes.forEach(cb => { if (cb.checked) completed++; });

      items.forEach(item => {
        const itemCheckboxes = item.querySelectorAll('.checkbox');
        const allChecked = Array.from(itemCheckboxes).every(cb => cb.checked);
        if (allChecked && itemCheckboxes.length > 0) item.classList.add('completed');
        else item.classList.remove('completed');
      });

      const percentage = checkboxes.length === 0 ? 0 : Math.round((completed / checkboxes.length) * 100);
      const progressBar = document.getElementById(`progress-${dayId}`);
      progressBar.style.width = percentage + '%';
      progressBar.textContent = percentage + '%';

      saveProgress(dayId);
    }

    function saveProgress(dayId) {
      const section = document.getElementById(dayId);
      const checkboxes = section.querySelectorAll('.checkbox');
      const progress = [];
      checkboxes.forEach(cb => progress.push(cb.checked));

      try {
        localStorage.setItem(`majo_progress_${dayId}`, JSON.stringify(progress));
      } catch (e) {}
    }

    function loadProgress(dayId) {
      try {
        const saved = localStorage.getItem(`majo_progress_${dayId}`);
        const section = document.getElementById(dayId);
        const checkboxes = section.querySelectorAll('.checkbox');

        if (saved) {
          const progress = JSON.parse(saved);
          checkboxes.forEach((cb, idx) => cb.checked = !!progress[idx]);
        } else {
          checkboxes.forEach(cb => cb.checked = false);
        }

        updateProgress(dayId);
      } catch (e) {}
    }

    function resetDay() {
      const activeSection = document.querySelector('.routine-section.active');
      const dayId = activeSection.id;

      if (confirm('¬øSeguro que quer√©s reiniciar el progreso de hoy?')) {
        const checkboxes = activeSection.querySelectorAll('.checkbox');
        checkboxes.forEach(cb => cb.checked = false);
        saveProgress(dayId);
        updateProgress(dayId);
      }
    }

    /**********************
     * TRACKING (registro pesos)
     **********************/
    function saveTracking(dayId) {
      const hip = document.getElementById(`track-${dayId}-hipthrust`).value || "";
      const rdl = document.getElementById(`track-${dayId}-rdl`).value || "";
      const prensa = document.getElementById(`track-${dayId}-prensa`).value || "";

      const payload = { hip, rdl, prensa, date: new Date().toISOString() };

      try {
        localStorage.setItem(`majo_track_${dayId}`, JSON.stringify(payload));
      } catch (e) {}

      const badge = document.getElementById(`saved-${dayId}`);
      badge.style.display = "inline-block";
      setTimeout(() => badge.style.display = "none", 1500);
    }

    function loadTracking(dayId) {
      try {
        const saved = localStorage.getItem(`majo_track_${dayId}`);
        if (!saved) return;

        const payload = JSON.parse(saved);
        document.getElementById(`track-${dayId}-hipthrust`).value = payload.hip || "";
        document.getElementById(`track-${dayId}-rdl`).value = payload.rdl || "";
        document.getElementById(`track-${dayId}-prensa`).value = payload.prensa || "";
      } catch (e) {}
    }

    function clearTracking(dayId) {
      document.getElementById(`track-${dayId}-hipthrust`).value = "";
      document.getElementById(`track-${dayId}-rdl`).value = "";
      document.getElementById(`track-${dayId}-prensa`).value = "";

      try {
        localStorage.removeItem(`majo_track_${dayId}`);
      } catch (e) {}
    }

    /**********************
     * INIT
     **********************/
    document.addEventListener('DOMContentLoaded', function() {

      renderDays();
      renderSections();

      // Timer
      document.getElementById('startBtn').addEventListener('click', startTimer);
      document.getElementById('pauseBtn').addEventListener('click', pauseTimer);
      document.getElementById('resetTimerBtn').addEventListener('click', resetTimerFunc);
      document.getElementById('resetDayBtn').addEventListener('click', resetDay);

      // Presets
      document.querySelectorAll('.preset-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const seconds = parseInt(this.getAttribute('data-seconds'));
          setTimer(seconds);
        });
      });

      // iPhone audio unlock
      document.getElementById("enableSoundBtn").addEventListener("click", async () => {
        const audio = document.getElementById("alarmSound");
        audio.currentTime = 0;

        try {
          await audio.play();
          audio.pause();
          audio.currentTime = 0;
        } catch (e) {}
      });

      // Tracking buttons
      document.querySelectorAll(".save-btn").forEach(btn => {
        btn.addEventListener("click", () => saveTracking(btn.dataset.day));
      });

      document.querySelectorAll(".clear-btn").forEach(btn => {
        btn.addEventListener("click", () => clearTracking(btn.dataset.day));
      });

      // Default day
      showDay("d1");
      updateTimerDisplay();
    });
  </script>
</body>
</html>
